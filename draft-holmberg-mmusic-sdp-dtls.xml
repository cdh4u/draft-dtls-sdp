<?xml version="1.0" encoding="iso-8859-1"?>
<!-- comment -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd"[]>
<?rfc toc="yes" ?>
<?rfc compact="yes" ?>
<?rfc sortrefs="no" ?>
<rfc ipr="trust200902" category="std" docName="draft-holmberg-mmusic-sdp-dtls-01.txt" submissionType="IETF" xml:lang="en">
  <front>
    <title>
		Using the SDP Offer/Answer Mechanism for DTLS
	</title>
    <author fullname="Christer Holmberg" initials="C.H." surname="Holmberg">
        <organization abbrev="Ericsson">Ericsson</organization>
        <address>
            <postal>
                <street>Hirsalantie 11</street>
                <city>Jorvas</city>
                <region></region>
                <code>02420</code>
                <country>Finland</country>
            </postal>
            <phone></phone>
            <email>christer.holmberg@ericsson.com</email>
        </address>
    </author>     	
    <author fullname="Roman Shpount" initials="R.S." surname="Shpount">
        <organization abbrev="TurboBridge">TurboBridge</organization>
        <address>
            <postal>
                <street>4905 Del Ray Avenue, Suite 300</street>
                <city>Bethesda</city>
                <region>MD</region>
                <code>20814</code>
                <country>USA</country>
            </postal>
            <phone>+1 (240) 292-6632</phone>
            <email>rshpount@turbobridge.com</email>
        </address>
    </author>

    <date year="2015" />
    <area>RAI</area>
    <abstract>
		<t>
            This draft defines the SDP offer/answer procedures for negotiating and establishing
            a DTLS association. The draft also defines the criteria for when a new DTLS association
            must be established.
        </t>
    </abstract>
</front>
<middle>
    <section title="Introduction">        
            <t>
                <xref format="default" pageno="false" target="RFC5763"/> defines SDP Offer/Answer procedures 
                for SRTP-DTLS. This draft defines the SDP Offer/Answer <xref format="default" pageno="false" 
                target="RFC3264"/> procedures for negotiation DTLS in general, based on the procedures in 
                <xref format="default" pageno="false" target="RFC5763"/>. 
            </t>
            <t>
                This draft also defines the usage of the SDP 'connection' attribute with DTLS. The attribute
                is used in SDP offers and answers to explicitly indicate whether a new DTLS association
                is to be established.
            </t>
            <t>
                As defined in [RFC5245], when Interactive Connectivity Establishment (ICE) <xref format="default" 
                pageno="false" target="RFC5245"/> is used, the ufrag value is changed both when ICE is negotiated,
                and when ICE restart <xref format="default" pageno="false" target="RFC5245"/> occurs. These events
                do not always require a new DTLS association to be established, but currently there is no way
                to explicitly indicate in an SDP offer or answer whether a new DTLS association is required.
                To solve that problem, this draft defines the usage of the SDP 'connection' attribute with DTLS. 
                The attribute is used in SDP offers and answers to explicitly indicate whether a new DTLS association 
                is to be established/re-established. The attribute can be used both with and without ICE.
            </t>
    </section>
    <section title="Establishing a new DTLS Association">
        <section title="General" anchor="sec-dtls-gen">
            <t>
                As defined in <xref format="default" pageno="false" target="RFC5763"/>, an endpoint MUST indicate (in an offer or answer) 
                that a new DTLS association to established in the following cases:
                <list style="symbols">
					<t>
						The DTLS roles change;
					</t>
					<t>
						The fingerprint (certificate) value changes;
					</t>
					<t>
                        The local transport parameters (IP address and/or port) of at least one endpoint change; or
					</t>
					<t>
                        If ICE is used and the ufrag value changes, and there is no explicit indication (SDP 'connection' attribute)
                        that a new DTLS association shall not be established;
					</t>
				</list>
            </t>
            <t>
                When a new DTLS association is established, an endpoint MUST use a new set of transport parameters 
                (IP address and port combination).
            </t>
        </section>
            
        <section title="ICE Considerations" anchor="sec-dtls-reest-ice">
            <t>
                An ICE restart <xref format="default" pageno="false" target="RFC5245"/> 
                does not by default require a new DTLS association to be established. A
                new DTLS association needs to be established only if or more of the
                criteria listed in <xref format="default" pageno="false" target="sec-dtls-gen"/>
                is fulfilled (e.g. if the local transport paramters change).
            </t>
            <t>
                As defined in <xref format="default" pageno="false" target="RFC5763"/>, 
                each ICE candidate associated with a component is treated as being part of the 
                same DTLS association. Therefore, from a DTLS perspective it is not considered 
                a change of local transport parameters when an endpoint switches between those 
                ICE candidates.
            </t>
        </section>
        
        <section title="SIP Considerations">
            <t>
                When the Session Initiation Protocol (SIP) <xref format="default" pageno="false" 
                target="RFC3261"/> is used as the signal protocol for establishing a multimedia 
                session, dialogs <xref format="default" pageno="false" target="RFC3261"/> might be 
                established between the caller and multiple callees. This is referred to as forking. 
                If forking occurs, separate DTLS associations MUST be established between the caller 
                and each callee.
            </t>
        </section>        
    </section>

	<section title="Abbreviations" toc="default">
		<t>
            TBD		
        </t>
	</section>
		
    <section title="Conventions">
		<t>
			The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
			"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
			document are to be interpreted as described in <xref target="RFC2119"></xref>.
		</t>
    </section>
            
	<section title="SDP Connection Attribute for DTLS">
        <section title="General">
            <t>
                The SDP 'connection' attribute <xref format="default" pageno="false" target="RFC4145"/> 
                was originally defined for connection-oriented protocols, e.g. TCP and TLS. This section 
                defines how the attribute is used with DTLS.
            </t>
            <t>
                A 'connection' attribute value of 'new' indicates that a new DTLS association MUST be
                established. A 'connection' attribute value of 'existing' indicates that a new DTLS
                association MUST NOT be established.
            </t>
            <t>
                When used with DTLS, there is no default value defined for the attribute. 
                Implementations that wish to use the attribute MUST explicitly include it in 
                SDP offers and answers. If an offer or answer does not contain an attribute, 
                other means needs to be used in order for endpoints to determine whether an 
                offer or answer is associated with an event that requires the DTLS association 
                to be re-established.
            </t>
        </section>        
    </section>
    
    <section title="SDP Offer/Answer Procedures" anchor="sec-oa">
        <section title="General">
            <t>
                This section defines the SDP offer/answer procedures for using the SDP 'connection' 
                attribute for DTLS. The section also describes how the usage of the SDP 'setup' 
                attribute and the SDP 'fingerprint' attribute <xref format="default" pageno="false" 
                target="RFC4572"/> is affected.
            </t>
            <t>
                The procedures in this section are based on the procedures for SRTP-DTLS
                <xref format="default" pageno="false" target="RFC5763"/>, with the addition
                of usage of the SDP 'connection' attribute.
            </t>
        </section>
        
        <section title="Generating the Initial SDP Offer">
            <t>
                When the offerer sends the initial offer, and the offerer wants to establish a 
                DTLS association, it MUST insert an SDP 'connection' attribute with a 'new' value 
                in the offer. In addition, the offerer MUST insert an SDP 'setup' attribute according 
                to the procedures in <xref format="default" pageno="false" target="RFC4572"/>, and 
                an SDP 'fingerprint' attribute according to the procedures in <xref format="default" 
                pageno="false" target="RFC4572"/>, in the offer.
            </t>
            <t>
                If ICE is used, the offerer MUST insert the SDP 'ice-ufrag' and 'ice-pwd' attributes
                according to the procedures in <xref format="default" pageno="false" target="RFC5245"/>
                in the offer.            
            </t>
        </section>
        <section title="Generating the Answer">       
            <t>
                If an answerer receives an offer that contains an SDP 'connection' attribute with a 'new' 
                value, the answerer MUST insert a 'new' value in the associated answer. The same applies
                if the answerer receives an offer that contains an SDP 'connection' attribute with a 'new'
                value, but the answerer determines (based on the criteria for establishing a new DTLS
                association) that a new DTLS association is to be established. In addition, the answerer MUST 
                insert an SDP 'setup' attribute according to the procedures in <xref format="default" 
                pageno="false" target="RFC4572"/>, and an SDP 'fingerprint' attribute according to the 
                procedures in <xref format="default" pageno="false" target="RFC4572"/>, in the answer.
            </t>
            <t>
                If the answerer does not accept the establishment of the DTLS association, it MUST 
                reject the "m=" lines associated with the suggested DTLS association <xref format="default" 
                pageno="false" target="RFC3264"/>.
            </t>
            <t>
                If an answerer receives an offer that contains a 'connection' attribute with an 'existing' value, 
                and if the answerer determines that a new DTLS association does not need to be established,
                it MUST insert a connection attribute with an 'existing' value in the associated answer. 
                In addition, the answerer MUST insert an SDP 'setup' attribute with a value that does not 
                change the previously negotiated  DTLS roles, and an SDP 'fingerprint' attribute with a value 
                that does not change the fingerprint, in the answer.
            </t>
            <t>
                If the answerer receives an offer that does not contain an SDP 'connection' attribute, 
                the answerer MUST NOT insert a 'connection' attribute in the answer.
            </t>
            <t>
                If ICE is used, the answerer MUST insert the SDP 'ice-ufrag' and 'ice-pwd' attributes
                according to the procedures in <xref format="default" pageno="false" target="RFC5245"/>
                in the answer.            
            </t>            
            <t>
                If a new DTLS association is to be established, and if the answerer 
                becomes DTLS client, the answerer MUST initiate the procedures for establishing 
                the DTLS association. If the answerer becomes DTLS server, it MUST wait for the offerer to 
                establish the DTLS association.
            </t>
        </section>
        <section title="Offerer Processing of the SDP Answer">
            <t>
                When an offerer receives an answer that contains an SDP 'connection' attribute with 
                a 'new' value, and if the offerer becomes DTLS client, the offerer MUST establish  
                a DTLS association. If the offerer becomes DTLS server, it MUST wait for the answerer to 
                establish the DTLS association.
            </t>
            <t>
                If the answer contains an SDP 'connection' attribute with an 'existing' value, the offerer 
                will continue using the previously established DTLS association. It is considered an error 
                case if the answer contains a 'connection' attribute with an 'existing' value, and a DTLS 
                association does not exist.
            </t>
        </section>
        <section title="Modifying the Session">
            <t>
                When the offerer sends a subsequent offer, and the offerer wants to establish a new 
                DTLS association, the offerer MUST insert an SDP 'connection' attribute with a 'new' 
                value in the offer. In addition, the offerer MUST insert an SDP 'setup' attribute 
                according to the procedures in <xref format="default" pageno="false" target="RFC4572"/>, 
                and an SDP 'fingerprint' attribute according to the procedures in <xref format="default" 
                pageno="false" target="RFC4572"/>, in the offer.
             </t>
             <t>
                when the offerer sends a subsequent offer, and the offerer does not want to establish
                a new DTLS association, if a previously established DTLS association exists, the 
                offerer MUST insert an SDP 'connection' attribute with an 'existing' value in the offer. 
                In addition, the offerer MUST insert an SDP 'setup' attribute with a value that does 
                not change the previously negotiated DTLS roles, and an SDP 'fingerprint' attribute with 
                a value that does not change the fingerprint, in the offer.
            </t>
            <t>
                If ICE is used, the offerer MUST insert the SDP 'ice-ufrag' and 'ice-pwd' attributes
                according to the procedures in <xref format="default" pageno="false" target="RFC5245"/>
                in the subsequent offer.            
            </t>
        </section>
	</section>

    <section title="RFC Updates">
		<t>
			Here we will add the RFC updates that are needed.
		</t>
	</section>
    
	<section title="Security Considerations">
		<t>
			This draft does not modify the security considerations associated with DTLS, or
            the SDP offer/answer mechanism. The draft simply clarifies the procedures for
            negotiating and establishing a DTLS association.
		</t>
	</section>
	
	<section title="IANA Considerations">
		<t>
            TBD
        </t>
	</section>
                   
	<section title="Acknowledgements">
		<t>
            Thanks to Justin Uberti, Martin Thomson, Paul Kyzivat and Jens Guballa 
            for providing comments and suggestions on the draft.
        </t>
	</section>
		
	<section title="Change Log">	
		<t>[RFC EDITOR NOTE: Please remove this section when publishing]</t>
        <t>Changes from draft-holmberg-mmusic-sdp-dtls-00
			<list style="symbols">
                <t>- Editorial changes and clarifications.</t>
			</list>
		</t>		

	</section>
</middle>

<back>
    <references title="Normative References">
		<?rfc include="reference.RFC.2119"?>
        <?rfc include="reference.RFC.3261"?>
		<?rfc include="reference.RFC.3264"?>
        <?rfc include="reference.RFC.4145"?>
        <?rfc include="reference.RFC.4572"?>
        <?rfc include="reference.RFC.5245"?>
        <?rfc include="reference.RFC.5763"?>
    </references>
</back>
</rfc>
